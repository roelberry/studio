module.exports=[59745,a=>{"use strict";var b=a.i(87924),c=a.i(59501),d=a.i(95245),e=a.i(36570),f=a.i(72131),g=a.i(71987),h=a.i(50944);a.i(69387);var i=a.i(60574);a.i(79597);var j=a.i(71559),k=a.i(99570),l=a.i(41921),m=a.i(66718),n=a.i(29246),o=a.i(91119),p=a.i(54614),q=a.i(5050),r=(0,q.createServerReference)("70f39668bff516cf01ffd0f6e1bcafbf5209556773",q.callServer,void 0,q.findSourceMapURL,"updateArtist"),s=a.i(59564),t=a.i(16157),u=a.i(33508),v=a.i(5084),w=a.i(33140);let x=["image/jpeg","image/jpg","image/png","image/webp"],y=e.instanceof(File).optional().refine(a=>!a||a.size<=4194304,"Max file size is 4MB.").refine(a=>!a||x.includes(a.type),"Only .jpg, .jpeg, .png and .webp formats are supported."),z=e.object({name:e.string().min(1,"Link name is required."),url:e.string().url("Please enter a valid URL.")}),A=e.object({name:e.string().min(2,"Name must be at least 2 characters."),statement:e.string().min(10,"Statement must be at least 10 characters."),profileImage:y,existingGalleryUrls:e.array(e.string().url()),newGalleryImages:e.array(y),links:e.array(z).optional(),tags:e.array(e.object({text:e.string().min(1)})).min(1,"Please add at least one tag.")});function B({params:a}){let{toast:e}=(0,p.useToast)(),q=(0,h.useRouter)(),x=(0,j.useFirestore)(),y=a.id,[z,B]=(0,f.useState)(null),[C,D]=(0,f.useState)(!0),E=(0,d.useForm)({resolver:(0,c.zodResolver)(A),defaultValues:{name:"",statement:"",existingGalleryUrls:[],newGalleryImages:[],links:[{name:"",url:""}],tags:[{text:""}]}});(0,f.useEffect)(()=>{y&&x&&(async()=>{D(!0);let a=(0,i.doc)(x,"artists",y),b=await (0,i.getDoc)(a);if(b.exists()){let a={id:b.id,...b.data()};B(a),E.reset({name:a.name,statement:a.statement,existingGalleryUrls:a.gallery,links:a.links.length>0?a.links:[{name:"",url:""}],tags:a.tags.map(a=>({text:a}))})}else e({variant:"destructive",title:"Not Found",description:"No artist found with this ID."}),q.push("/admin");D(!1)})()},[y,x,E,q,e]);let{fields:F,append:G,remove:H}=(0,d.useFieldArray)({control:E.control,name:"links"}),{fields:I,append:J,remove:K}=(0,d.useFieldArray)({control:E.control,name:"newGalleryImages"}),{fields:L,append:M,remove:N}=(0,d.useFieldArray)({control:E.control,name:"tags"}),O=E.watch("existingGalleryUrls");async function P(a){if(!z)return;let b=new FormData;b.append("name",a.name),b.append("statement",a.statement),a.profileImage&&a.profileImage.size>0&&b.append("profileImage",a.profileImage),b.append("existingGalleryUrls",JSON.stringify(a.existingGalleryUrls)),a.newGalleryImages.forEach(a=>{a&&a.size>0&&b.append("gallery",a)}),a.links&&b.append("links",JSON.stringify(a.links)),b.append("tags",JSON.stringify(a.tags));let c=await r(y,b,z);c.success?(e({title:"Success!",description:`Artist "${a.name}" has been updated.`}),q.push("/admin")):e({variant:"destructive",title:"Uh oh! Something went wrong.",description:c.error||"There was a problem with your request."})}return C?(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsx)(w.Skeleton,{className:"h-9 w-1/2"}),(0,b.jsx)(w.Skeleton,{className:"h-5 w-3/4"})]}),(0,b.jsxs)(o.CardContent,{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(w.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(w.Skeleton,{className:"h-10 w-full"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(w.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(w.Skeleton,{className:"h-10 w-full"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(w.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(w.Skeleton,{className:"h-24 w-full"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(w.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(w.Skeleton,{className:"h-20 w-full"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(w.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(w.Skeleton,{className:"h-10 w-full"})]}),(0,b.jsx)(w.Skeleton,{className:"h-10 w-32"})]})]})}):(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsx)(o.CardTitle,{className:"text-3xl font-headline",children:"Edit Artist"}),(0,b.jsxs)(o.CardDescription,{children:["Update the details for ",E.getValues("name"),"."]})]}),(0,b.jsx)(o.CardContent,{children:(0,b.jsx)(l.Form,{...E,children:(0,b.jsxs)("form",{onSubmit:E.handleSubmit(P),className:"space-y-8",children:[(0,b.jsx)(l.FormField,{control:E.control,name:"name",render:({field:a})=>(0,b.jsxs)(l.FormItem,{children:[(0,b.jsx)(l.FormLabel,{children:"Artist/Collective Name"}),(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"e.g., Jane Doe",...a})}),(0,b.jsx)(l.FormMessage,{})]})}),(0,b.jsxs)(l.FormItem,{children:[(0,b.jsx)(l.FormLabel,{children:"Profile Image"}),z?.profileImage&&(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(g.default,{src:z.profileImage,alt:"Current profile image",width:150,height:150,className:"rounded-md object-cover"})}),(0,b.jsx)(l.FormField,{control:E.control,name:"profileImage",render:({field:{onChange:a,value:c,...d}})=>(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(m.Input,{type:"file",accept:"image/*",onChange:b=>{let c=b.target.files?.[0];c&&a(c)},...d})})}),(0,b.jsx)(l.FormDescription,{children:"Upload a new image to replace the current one."}),(0,b.jsx)(l.FormMessage,{})]}),(0,b.jsx)(l.FormField,{control:E.control,name:"statement",render:({field:a})=>(0,b.jsxs)(l.FormItem,{children:[(0,b.jsx)(l.FormLabel,{children:"Artist Statement"}),(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(n.Textarea,{placeholder:"Tell us about the artist's work...",rows:5,...a})}),(0,b.jsx)(l.FormMessage,{})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.FormLabel,{children:"Gallery Images"}),(0,b.jsx)(l.FormDescription,{className:"mb-4",children:"Manage the artist's gallery images."}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:O.map((a,c)=>(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)(g.default,{src:a,alt:`Gallery image ${c+1}`,width:200,height:200,className:"rounded-md object-cover aspect-square"}),(0,b.jsx)(k.Button,{type:"button",variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100",onClick:()=>{let a;(a=[...O]).splice(c,1),E.setValue("existingGalleryUrls",a)},children:(0,b.jsx)(u.X,{className:"h-4 w-4"})})]},c))}),(0,b.jsx)(l.FormLabel,{className:"text-sm font-medium",children:"Add New Images"}),I.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 py-2",children:[(0,b.jsx)(l.FormField,{control:E.control,name:`newGalleryImages.${c}`,render:({field:{onChange:a,value:c,...d}})=>(0,b.jsxs)(l.FormItem,{className:"flex-1",children:[(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(m.Input,{type:"file",accept:"image/*",onChange:b=>{let c=b.target.files?.[0];c&&a(c)},...d})}),(0,b.jsx)(l.FormMessage,{})]})}),(0,b.jsx)(k.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>K(c),children:(0,b.jsx)(t.MinusCircle,{className:"text-destructive"})})]},a.id)),(0,b.jsxs)(k.Button,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>J(void 0),children:[(0,b.jsx)(s.PlusCircle,{className:"mr-2 h-4 w-4"}),"Add New Image"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.FormLabel,{children:"Tags"}),(0,b.jsx)(l.FormDescription,{className:"mb-4",children:"Add tags that describe the artist's work."}),L.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 py-2",children:[(0,b.jsx)(l.FormField,{control:E.control,name:`tags.${c}.text`,render:({field:a})=>(0,b.jsxs)(l.FormItem,{className:"flex-1",children:[(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"e.g., Social Justice",...a})}),(0,b.jsx)(l.FormMessage,{})]})}),(0,b.jsx)(k.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>N(c),disabled:L.length<=1,children:(0,b.jsx)(t.MinusCircle,{className:"text-destructive"})})]},a.id)),(0,b.jsxs)(k.Button,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>M({text:""}),children:[(0,b.jsx)(s.PlusCircle,{className:"mr-2 h-4 w-4"}),"Add Tag"]}),(0,b.jsx)(l.FormMessage,{children:E.formState.errors.tags?.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.FormLabel,{children:"Links"}),(0,b.jsx)(l.FormDescription,{className:"mb-4",children:"Add links to the artist's website, social media, etc."}),F.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 py-2",children:[(0,b.jsx)(l.FormField,{control:E.control,name:`links.${c}.name`,render:({field:a})=>(0,b.jsxs)(l.FormItem,{className:"flex-1",children:[(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"Link Name (e.g. Website)",...a})}),(0,b.jsx)(l.FormMessage,{})]})}),(0,b.jsx)(l.FormField,{control:E.control,name:`links.${c}.url`,render:({field:a})=>(0,b.jsxs)(l.FormItem,{className:"flex-1",children:[(0,b.jsx)(l.FormControl,{children:(0,b.jsx)(m.Input,{placeholder:"URL (e.g. https://...)",...a})}),(0,b.jsx)(l.FormMessage,{})]})}),(0,b.jsx)(k.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>H(c),disabled:F.length<=1&&""===E.getValues(`links.${c}.name`)&&""===E.getValues(`links.${c}.url`),children:(0,b.jsx)(t.MinusCircle,{className:"text-destructive"})})]},a.id)),(0,b.jsxs)(k.Button,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>G({name:"",url:""}),children:[(0,b.jsx)(s.PlusCircle,{className:"mr-2 h-4 w-4"}),"Add Link"]})]}),(0,b.jsx)(v.Separator,{}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(k.Button,{type:"submit",disabled:E.formState.isSubmitting,children:E.formState.isSubmitting?"Updating...":"Update Artist"}),(0,b.jsx)(k.Button,{type:"button",variant:"outline",onClick:()=>q.push("/admin"),children:"Cancel"})]})]})})})]})})}a.s(["default",()=>B],59745)}];

//# sourceMappingURL=src_app_admin_edit_%5Bid%5D_page_tsx_338f75cc._.js.map